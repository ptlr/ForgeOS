# <h1 align="center">N01 内存分布</h1>

## 一、BIOS在低1MB的内存分布情况

|    内存分段     | 大小            | 用途                                                         | 备注                                                         |
| :-------------: | --------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 0x00000~0x003FF | 1KB             | 中断向量表（Interrupt Vector Table, IVT）,每项4个字节，共1024个字节，256个中断。 |                                                              |
| 0x00400~0x004FF | 256B            | BIOS数据区                                                   |                                                              |
| 0x00500~0x07BFF | 30464B,约30KB   | 空闲，可用区域                                               |                                                              |
| 0x07C00~0x07DFF | 512B            | MBR被加载到这里                                              |                                                              |
| 0x07E00~0x9FBFF | 622080B,约608KB | 空闲，可用区域                                               | windows下bochs中查询的结果与查到的资料有些不同，这一段区域截止于0x9F000,还有一段没有查询到 |
| 0x9FC00~0x9FFFF | 1KB             | 扩展BIOS数据区（Extend BIOS Data Area，EBDA）                |                                                              |
| 0xA0000~0xAFFFF | 64KB            | 用于彩色显示适配器                                           |                                                              |
| 0xB0000~0xB7FFF | 32KB            | 用于黑白显示适配器                                           |                                                              |
| 0xB8000~0xBFFFF | 32KB            | 用于文本模式显示适配器                                       |                                                              |
| 0xC0000~0xC7FFF | 32KB            | 显示器适配器BIOS                                             |                                                              |
| 0xC8000~0xEFFFF | 160KB           | 映射硬件的ROM或内存映射式I/O                                 |                                                              |
| 0xF0000~0xFFFFF | 64KB            | 系统BIOS,最后的0xFFFF0~0xFFFFF，共16B,是BIOS的入口地址，保存着指令`jmp 0xF000:E05B` |                                                              |

## 二、ForgeOS内存分布

|     内存分段      | 大小            | 用途                                                         | 备注                                                         |
| :---------------: | --------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 0x000000~0x0003FF | 1KB             | 中断向量表（Interrupt Vector Table, IVT）,每项4个字节，共1024个字节。 |                                                              |
| 0x000400~0x0004FF | 256B            | BIOS数据区                                                   |                                                              |
| 0x000500~0x007BFF | 30464B,约30KB   | 空闲，可用区域                                               | ForgeOS, BootLoader用到的堆栈区                              |
| 0x007C00~0x007DFF | 512B            | MBR被加载到这里                                              |                                                              |
| 0x007E00-0x0081FF | 1KB             | 内存信息保存区域                                             | 前4个字字节保存，信息结构体的个数。                          |
| 0x008200~0x0085FF | 1KB             | VBE信息保存区域                                              |                                                              |
| 0x008600~0x09FBFF | 620032B,约605KB | ForgeOS loader保存区域                                       |                                                              |
| 0x09FC00~0x09FFFF | 1KB             | 扩展BIOS数据区（Extend BIOS Data Area，EBDA）                |                                                              |
| 0x0A0000~0x0AFFFF | 64KB            | 用于彩色显示适配器                                           |                                                              |
| 0x0B0000~0x0B7FFF | 32KB            | 用于黑白显示适配器                                           |                                                              |
| 0x0B8000~0x0BFFFF | 32KB            | 用于文本模式显示适配器                                       |                                                              |
| 0x0C0000~0x0C7FFF | 32KB            | 显示器适配器BIOS                                             |                                                              |
| 0x0C8000~0x0EFFFF | 160KB           | 映射硬件的ROM或内存映射式I/O                                 |                                                              |
| 0x0F0000~0x0FFFFF | 64KB            | 系统BIOS,最后的0xFFFF0~0xFFFFF，共16B,是BIOS的入口地址，保存着指令`jmp 0xF000:E05B` |                                                              |
| 0x100000~0x1EEFFF | 约955.9KB       | 内核位置                                                     | 到内核区域时再做详细划分，15MB-16MB的位置可能存在一个ISA Memory Hole，需要注意。 |
| 0x1EF000~0x1F2FFF | 16KB            | 内核物理内存位图位置                                         | 以管理512MB内存大小来设计                                    |
| 0x1F3000~0x1FAFFF | 16KB            | 内核虚拟内存位图位置                                         | 以管理512MB内存大小来设计                                    |
| 0x1F7000~0x1FAFFF | 16KB            | 用户物理内存位图位置                                         | 以管理512MB内存大小来设计                                    |
| 0x1FB000~0x1FEFFF | 16KB            | 用户虚拟内存位图位置                                         | 以管理512MB内存大小来设计                                    |
| 0x1FF000~0x1FFFFF | 4KB             | 内核主线程PCB                                                |                                                              |
| 0x200000~0x200FFF | 4KB             | 操作系统的页目录表                                           |                                                              |
| 0x201000~0x201FFF | 4KB             | 操作系统的第一个页表                                         | 映射2MB的内容                                                |